# UI 设计文档

## 1. 整体风格

- **设计语言**: 简洁、现代、与 VS Code 原生风格一致
- **配色方案**: 跟随 VS Code 主题（自适应）
- **字体**: 系统默认字体栈
- **图标**: 
  - 禁止使用 Material Icons、Font Awesome 等 Web 字体图标
  - 使用 VS Code Codicons（`codicon` 类）
  - vscode-elements 组件自带图标优先使用

## 2. 主要界面

### 2.1 翻译结果面板 (Translation Result Panel)

支持两种显示模式，用户可在设置中切换：

| 模式 | 触发方式 | 特点 |
|-----|---------|------|
| **简版模式** | 右键翻译、快捷键 | 悬浮卡片，简洁快速，点击外部自动隐藏 |
| **正常模式** | 命令面板、详细翻译按钮 | 完整面板，功能全面，持久显示 |

---

#### 2.1.1 简版模式 (Simple Mode)

简洁的悬浮卡片，鼠标悬停或选中文字后快速翻译。

**图标说明：**
- 所有图标使用 VS Code Codicons
- 复制：`codicon-copy`
- 展开：`codicon-arrow-up-right`
- 发音：`codicon-unmute`
- 加载：`codicon-loading~spin`

```
                    ┌─────────────────────────────────────────┐
                    │  翻译中... ⏳                           │
                    └─────────────────────────────────────────┘


┌────────────────────────────────────────────┐
│ "console.log"                              │  ← 用户选中的代码
└────────────────────────────────────────────┘
         │
         │ 右键 → 🌐 翻译
         ▼
    ┌──────────────────────────────────────────┐
    │ 控制台.日志                        [📋] │  ← 点击翻译文本复制
    │                                          │
    │ 🔊 /kənˈsəʊl lɒɡ/                   [↗] │  ← 点击打开详细面板
    │                                          │
    │ ──────────────────────────────────────── │
    │ EN → 中文  •  千问  •  0.8s             │
    └──────────────────────────────────────────┘
                      ↑
         点击外部区域自动隐藏
```

**简版模式 - 多个翻译结果：**

```
    ┌──────────────────────────────────────────┐
    │ 📝 敏捷的棕色狐狸跳过懒狗            [📋] │  ← 主要翻译结果
    │ ──────────────────────────────────────── │
    │ 其他翻译:                                │
    │ • 快速的棕色狐狸跃过懒狗            [📋] │  ← 点击复制替代翻译
    │ • 迅捷的棕狐跳过懒犬                [📋] │
    │ ──────────────────────────────────────── │
    │ [查看详情 ↗]  EN → 中文  •  DeepSeek    │
    └──────────────────────────────────────────┘
```

**简版模式 - 生词本功能：**

```
    ┌──────────────────────────────────────────┐
    │ 人工智能                                 │
    │ /ˌɑːtɪfɪʃl ɪnˈtelɪdʒəns/           [🔊] │
    │                                          │
    │ n. 人工智能；机器智能                    │
    │                                          │
    │ ──────────────────────────────────────── │
    │ [查看详情 ↗]                            │
    └──────────────────────────────────────────┘
```

**简版模式 - 可配置显示项：**

默认仅显示核心翻译结果，其他信息可通过设置开启：

```
默认状态（最简）:
┌────────────────────────────┐
│ 你好世界               [📋]│
└────────────────────────────┘

开启全部选项后:
┌──────────────────────────────────────────┐
│ 你好世界                               [📋]│
│ 🔊 /nɪˌhɑːˈwɜːrld/                     [↗]│
│ ──────────────────────────────────────── │
│ EN → 中文  •  千问  •  0.8s              │
└──────────────────────────────────────────┘
```

**简版模式显示设置：**

| 设置项 | 默认值 | 说明 |
|-------|-------|------|
| 显示发音 | ❌ 关闭 | 显示音标和播放按钮 |
| 显示语言方向 | ❌ 关闭 | 显示 "EN → 中文" |
| 显示提供商 | ❌ 关闭 | 显示使用的大模型 |
| 显示耗时 | ❌ 关闭 | 显示请求耗时 |
| 显示"查看详情"按钮 | ✅ 开启 | 展开到正常模式 |

**简版模式交互行为：**

| 操作 | 行为 |
|-----|------|
| 点击翻译文本 | 复制到剪贴板，显示"已复制"提示 |
| 点击复制按钮 (codicon-copy) | 复制对应文本 |
| 点击发音按钮 (codicon-unmute) | 播放发音（如果支持） |
| 点击展开按钮 (codicon-arrow-up-right) | 打开正常模式面板 |
| 点击外部区域 | 自动隐藏（0.3s 淡出动画） |
| 按 Esc 键 | 立即隐藏 |
| 选中其他文本 | 自动关闭当前，显示新的翻译 |

**简版模式设置面板预览：**

```
简版模式设置
────────────────────────────────────────
显示选项
  [✓] 显示"查看详情"按钮          默认: 开启
  [ ] 显示发音 (音标/播放)         默认: 关闭
  [ ] 显示语言方向 (EN→中文)       默认: 关闭
  [ ] 显示提供商 (千问/DeepSeek等) 默认: 关闭
  [ ] 显示请求耗时 (0.8s)          默认: 关闭
  [✓] 显示替代翻译                 默认: 开启
      最多显示数量: [2 ▼]

行为设置
────────────────────────────────────────
  [✓] 点击外部自动隐藏
  自动隐藏延迟: [300] ms
  卡片位置: [自动检测 ▼]
```

**简版模式定位逻辑：**

```
编辑器区域
┌──────────────────────────────────────────────────────────┐
│                                                          │
│       选中文本                                           │
│       ┌──────────────┐                                   │
│       │ hello world  │  ──► 卡片显示在选区下方           │
│       └──────────────┘      距离 8px                     │
│            │                                             │
│            ▼                                             │
│       ┌──────────────────┐                               │
│       │ 你好世界     [📋]│                               │
│       └──────────────────┘                               │
│                                                          │
│  如果下方空间不足，则显示在选区上方                        │
│                                                          │
└──────────────────────────────────────────────────────────┘
```

---

#### 2.1.2 正常模式 (Full Mode)

功能完整的翻译面板，支持详细设置和多次翻译。

```
┌─────────────────────────────────────────────────────────────────────┐
│  🌐 翻译结果                                    [✕] [□] [─]         │
├─────────────────────────────────────────────────────────────────────┤
│  [简版 ▼]  ← 可在简版/正常模式间切换                              │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ 源语言                    目标语言 ▼  [🔄] [📋]               │   │
│  │ [English ▼]    ───────►   [中文 ▼]                          │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ 原文                                                        │   │
│  │ ┌─────────────────────────────────────────────────────────┐ │   │
│  │ │ The quick brown fox jumps over the lazy dog.           │ │   │
│  │ └─────────────────────────────────────────────────────────┘ │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ 翻译结果                                [📋] [📝] [🔄]     │   │
│  │ ┌─────────────────────────────────────────────────────────┐ │   │
│  │ │ 敏捷的棕色狐狸跳过懒狗。                               │ │   │
│  │ └─────────────────────────────────────────────────────────┘ │   │
│  │                                                             │   │
│  │ 🔊 /ðə kwɪk braʊn fɒks dʒʌmps ˈəʊvə ðə ˈleɪzi dɒɡ/        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ ▼ 词汇详解                                                  │   │
│  │ ─────────────────────────────────────────────────────────── │   │
│  │ • quick  /kwɪk/    adj. 快速的，敏捷的                      │   │
│  │ • brown  /braʊn/   adj. 棕色的，褐色的                      │   │
│  │ • fox    /fɒks/    n.   狐狸                                │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ ▶ 替代翻译                                                  │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ ▶ 例句                                                      │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ 提供商: DeepSeek • 模型: deepseek-chat • 耗时: 1.2s        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**面板元素说明：**

| 元素 | 说明 |
|-----|------|
| 模式切换器 | 简版/正常模式快速切换 |
| 语言选择器 | 下拉选择源/目标语言，支持互换 (codicon-arrow-swap) |
| 操作按钮 | 重新翻译 (codicon-refresh)、复制 (codicon-copy) |
| 原文框 | 可编辑，修改后可重新翻译 |
| 结果框 | 可编辑，支持一键替换到编辑器 (codicon-replace) |
| 发音 | 点击播放发音 (codicon-unmute)，显示音标 |
| 折叠面板 | 词汇、替代翻译、例句可折叠 (codicon-chevron-down/codicon-chevron-right) |
| 底部信息 | 显示提供商、模型、耗时等信息 |

### 2.2 设置页面 (Settings Panel)

```
┌─────────────────────────────────────────────────────────────────────┐
│  ⚙️ LLM Translation 设置                        [✕] [□] [─]         │
├─────────────────────────────────────────────────────────────────────┤
│  ┌────────────────┬──────────────────────────────────────────────┐  │
│  │                │                                              │  │
│  │  📋 通用设置   │   默认设置                                   │  │
│  │                │   ────────────────────────────────────────   │  │
│  │  🔑 提供商     │   默认提供商        [千问 ▼]                 │  │
│  │                │   默认目标语言      [中文 ▼]                 │  │
│  │  📝 提示词     │   自动检测语言      [✓]                      │  │
│  │                │   自动复制结果      [ ]                      │  │
│  │                │                                              │  │
│  │                │   显示设置                                   │  │
│  │                │   ────────────────────────────────────────   │  │
│  │                │   [✓] 显示发音                               │  │
│  │                │   [✓] 显示词汇详解                           │  │
│  │                │   [✓] 显示替代翻译                           │  │
│  │                │   [✓] 显示例句                               │  │
│  │                │   [ ] 悬浮按钮                               │  │
│  │                │                                              │  │
│  │                │   缓存设置                                   │  │
│  │                │   ────────────────────────────────────────   │  │
│  │                │   启用缓存          [✓]                      │  │
│  │                │   缓存时间          [7 ▼] 天                 │  │
│  │                │                                              │  │
│  └────────────────┴──────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────┘
```

#### 提供商设置页

```
│  🔑 提供商设置                                                    │
│  ───────────────────────────────────────────────────────────────  │
│                                                                   │
│  ┌─ 千问 (Qwen) ──────────────────────────────────────────────┐  │
│  │                                                             │  │
│  │   [✓] 启用                                                  │  │
│  │                                                             │  │
│  │   API Key        [************************************]    │  │
│  │                   [🔗 获取 API Key]                         │  │
│  │                                                             │  │
│  │   模型           [qwen-turbo ▼]                            │  │
│  │   Base URL       [https://dashscope.aliyuncs.com]          │  │
│  │                                                             │  │
│  │   温度           [0.7 ───────────────●──────]               │  │
│  │   Max Tokens     [2048 ▼]                                  │  │
│  │                                                             │  │
│  │                              [测试连接 ✅]                   │  │
│  │                                                             │  │
│  └─────────────────────────────────────────────────────────────┘  │
│                                                                   │
│  ┌─ DeepSeek ─────────────────────────────────────────────────┐  │
│  │   ...                                                       │  │
│  └─────────────────────────────────────────────────────────────┘  │
│  ┌─ Kimi ─────────────────────────────────────────────────────┐  │
│  │   ...                                                       │  │
│  └─────────────────────────────────────────────────────────────┘  │
│  ┌─ GLM ──────────────────────────────────────────────────────┐  │
│  │   ...                                                       │  │
│  └─────────────────────────────────────────────────────────────┘  │
```

#### 提示词模板设置页

```
│  📝 提示词模板                                                    │
│  ───────────────────────────────────────────────────────────────  │
│                                                                   │
│  ┌────────────────────┬────────────────────────────────────────┐ │
│  │                    │                                        │ │
│  │  📄 标准翻译       │   模板名称                             │ │
│  │  📄 学术翻译       │   [标准翻译模板              ]         │ │
│  │  📄 口语翻译       │                                        │ │
│  │  📄 代码注释       │   模板内容                             │ │
│  │  ➕ 新建模板       │   ┌────────────────────────────────┐   │ │
│  │                    │   │                                │   │ │
│  │                    │   │  请将以下文本从 {sourceLang}   │   │ │
│  │                    │   │  翻译为 {targetLang}：         │   │ │
│  │                    │   │                                │   │ │
│  │                    │   │  {text}                        │   │ │
│  │                    │   │                                │   │ │
│  │                    │   │  请以 JSON 格式返回：          │   │ │
│  │                    │   │  {{                           │   │ │
│  │                    │   │    "translation": "...",       │   │ │
│  │                    │   │    "pronunciation": "..."      │   │ │
│  │                    │   │  }}                            │   │ │
│  │                    │   │                                │   │ │
│  │                    │   └────────────────────────────────┘   │ │
│  │                    │                                        │ │
│  │                    │   可用变量                             │ │
│  │                    │   ──────────────────────────────────   │ │
│  │                    │   • {text} - 要翻译的文本              │ │
│  │                    │   • {sourceLang} - 源语言              │ │
│  │                    │   • {targetLang} - 目标语言            │ │
│  │                    │   • {detectedLang} - 检测到的语言      │ │
│  │                    │                                        │ │
│  │                    │   输出格式                             │ │
│  │                    │   [JSON ▼]                             │ │
│  │                    │                                        │ │
│  │                    │   [保存] [重置] [导入] [导出]          │ │
│  │                    │                                        │ │
│  └────────────────────┴────────────────────────────────────────┘ │
```

## 3. 交互组件

### 3.1 Quick Pick 快速选择

```
┌────────────────────────────────────────────────────┐
│  选择目标语言                                      │
│  >                                                 │
│  ─────────────────────────────────────────────     │
│  中文 (Chinese)                                    │
│  English (英语)                                    │
│  日本語 (Japanese)                                 │
│  Français (法语)                                   │
│  Deutsch (德语)                                    │
│  Español (西班牙语)                                │
│  ─────────────────────────────────────────────     │
│  ⚙️ 配置语言选项...                                │
└────────────────────────────────────────────────────┘
```

### 3.2 Hover 悬浮提示

```
┌─────────────────────────────────────────┐
│ 🌐 翻译                                 │
│ ─────────────────────────────────────── │
│ 选中: "console.log"                     │
│                                         │
│ 中文: 控制台.日志                       │
│                                         │
│ [翻译为英语] [翻译为日语] [详细翻译...] │
└─────────────────────────────────────────┘
```

### 3.3 状态栏

```
┌────────────────────────────────────────────────────────────────────┐
│ ... │ UTF-8 │ TypeScript │ 🌐 千问: 中文 │ 🔔 │ 🌙 │ 🐛 │ 📝 │ 14:32 │
│                                 └─── 点击显示快速菜单              │
└────────────────────────────────────────────────────────────────────┘
```

### 3.4 右键菜单

```
┌──────────────────────────────────────┐
│ 转到定义                             │
│ 转到类型定义                         │
│ ...                                  │
│ ──────────────────────────────────   │
│ 剪切                                 │
│ 复制                                 │
│ 粘贴                                 │
│ ──────────────────────────────────   │
│ 🌐 翻译                              │
│ 🌐 翻译为英语                        │
│ 🌐 翻译为中文                        │
│ 🌐 翻译为日语                        │
│ 🌐 翻译并替换                        │
│ ──────────────────────────────────   │
│ 命令面板...                          │
└──────────────────────────────────────┘
```

### 3.5 通知消息

```
┌─────────────────────────────────────────────────────────┐
│ ℹ️ 正在翻译...                                          │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ ✅ 翻译完成!                     [查看] [复制] [忽略]   │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ ❌ 翻译失败: API 密钥无效        [配置] [重试]          │
└─────────────────────────────────────────────────────────┘
```

## 4. 响应式布局

### 面板宽度适配

| 宽度 | 布局 |
|-----|------|
| > 600px | 双栏：左侧原文，右侧结果 |
| 400-600px | 单栏：上下排列 |
| < 400px | 紧凑模式，精简显示 |

### 主题适配

- 自动跟随 VS Code 主题（Dark/Light/High Contrast）
- 使用 CSS 变量：`var(--vscode-editor-background)`
- 支持自定义强调色
