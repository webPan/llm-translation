{
  "version": 3,
  "sources": ["../../../src/webview/views/simple.ts"],
  "sourcesContent": ["export {};\r\n\r\ntype BridgeMessage<TPayload = any> = {\r\n  type: string;\r\n  id?: string;\r\n  timestamp?: number;\r\n  payload?: TPayload;\r\n  response?: any;\r\n};\r\n\r\ndeclare const acquireVsCodeApi: () => { postMessage: (msg: any) => void };\r\n\r\nconst vscode = acquireVsCodeApi();\r\n\r\nlet currentResult: any = null;\r\n\r\nfunction post(type: string, payload?: any): void {\r\n  vscode.postMessage({ type, id: genId(), timestamp: Date.now(), payload });\r\n}\r\n\r\nfunction genId(): string {\r\n  return `id_${Date.now()}_${Math.random().toString(36).slice(2, 10)}`;\r\n}\r\n\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div');\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\nfunction getLanguageName(code: string): string {\r\n  const names: Record<string, string> = { zh: '\u4E2D\u6587', en: 'English', ja: '\u65E5\u672C\u8A9E', auto: '\u81EA\u52A8' };\r\n  return names[code] || code;\r\n}\r\n\r\nfunction formatDuration(ms: number): string {\r\n  if (!Number.isFinite(ms)) return '';\r\n  if (ms < 1000) return `${Math.round(ms)}ms`;\r\n  return `${(ms / 1000).toFixed(2)}s`;\r\n}\r\n\r\nfunction renderResult(result: any): void {\r\n  const app = document.getElementById('app');\r\n  if (!app) return;\r\n\r\n  if (!result) {\r\n    app.innerHTML = `<p style=\"color: var(--vscode-descriptionForeground);\">\u6682\u65E0\u7FFB\u8BD1\u7ED3\u679C</p>`;\r\n    return;\r\n  }\r\n\r\n  const translation = String(result.translation || '');\r\n  const pronunciation = String(result.pronunciation || '');\r\n  const alternatives: string[] = Array.isArray(result.alternatives) ? result.alternatives : [];\r\n  const meta = result.meta || {};\r\n\r\n  const lang = meta.sourceLang && meta.targetLang\r\n    ? `${getLanguageName(meta.sourceLang)} \u2192 ${getLanguageName(meta.targetLang)}`\r\n    : '';\r\n\r\n  app.innerHTML = `\r\n    <div style=\"display:flex; flex-direction:column; gap:10px;\">\r\n      <div style=\"font-size: 14px; line-height: 1.6;\">${escapeHtml(translation)}</div>\r\n      ${pronunciation ? `<div style=\"font-style: italic; color: var(--vscode-textLink-foreground);\">${escapeHtml(pronunciation)}</div>` : ''}\r\n\r\n      ${(lang || meta.provider || meta.duration) ? `\r\n        <div style=\"font-size: 11px; color: var(--vscode-descriptionForeground); display:flex; gap:10px; flex-wrap: wrap;\">\r\n          ${lang ? `<span>${escapeHtml(lang)}</span>` : ''}\r\n          ${meta.provider ? `<span>${escapeHtml(String(meta.provider))}</span>` : ''}\r\n          ${meta.duration ? `<span>${escapeHtml(formatDuration(Number(meta.duration)))}</span>` : ''}\r\n        </div>\r\n      ` : ''}\r\n\r\n      <div style=\"display:flex; gap:8px;\">\r\n        <button class=\"action-copy\" style=\"flex:1;\">\u590D\u5236</button>\r\n        <button class=\"action-expand\" style=\"flex:1;\">\u8BE6\u60C5</button>\r\n        <button class=\"action-replace\" style=\"flex:1;\">\u66FF\u6362</button>\r\n      </div>\r\n\r\n      ${alternatives.length ? `\r\n        <div style=\"border-top:1px solid var(--vscode-panel-border); padding-top:8px;\">\r\n          <div style=\"font-size: 11px; color: var(--vscode-descriptionForeground); margin-bottom:6px;\">\u5176\u4ED6\u7FFB\u8BD1</div>\r\n          <div style=\"display:flex; flex-direction:column; gap:4px;\">\r\n            ${alternatives.map((alt, i) => `<div class=\"alternative-item\" data-index=\"${i}\" style=\"cursor:pointer; padding:4px 0;\">${escapeHtml(String(alt))}</div>`).join('')}\r\n          </div>\r\n        </div>\r\n      ` : ''}\r\n    </div>\r\n  `;\r\n}\r\n\r\nfunction showProgress(message?: string): void {\r\n  const app = document.getElementById('app');\r\n  if (!app) return;\r\n  app.innerHTML = `<p style=\"color: var(--vscode-descriptionForeground);\">${escapeHtml(message || '\u6B63\u5728\u7FFB\u8BD1...')}</p>`;\r\n}\r\n\r\nfunction showError(error: string): void {\r\n  const app = document.getElementById('app');\r\n  if (!app) return;\r\n  app.innerHTML = `<p style=\"color: var(--vscode-errorForeground);\">${escapeHtml(error)}</p>`;\r\n}\r\n\r\nwindow.addEventListener('message', (event: MessageEvent<BridgeMessage>) => {\r\n  const message = event.data;\r\n  if (!message || !message.type) return;\r\n\r\n  if (message.type === 'translate.result') {\r\n    currentResult = message.payload?.result;\r\n    renderResult(currentResult);\r\n  } else if (message.type === 'translate.progress') {\r\n    showProgress(message.payload?.message);\r\n  } else if (message.type === 'translate.error') {\r\n    showError(String(message.payload?.error || '\u7FFB\u8BD1\u5931\u8D25'));\r\n  }\r\n});\r\n\r\ndocument.addEventListener('click', (e) => {\r\n  const target = e.target as HTMLElement | null;\r\n  if (!target) return;\r\n\r\n  if (target.classList.contains('action-copy')) {\r\n    post('action.copy');\r\n  } else if (target.classList.contains('action-expand')) {\r\n    post('action.expand');\r\n  } else if (target.classList.contains('action-replace')) {\r\n    post('action.replace');\r\n  } else if (target.classList.contains('alternative-item')) {\r\n    const index = Number(target.getAttribute('data-index'));\r\n    if (Number.isFinite(index)) {\r\n      post('action.selectAlternative', { index });\r\n    }\r\n  }\r\n});\r\n\r\npost('panel.focus');\r\nshowProgress('\u7B49\u5F85\u7FFB\u8BD1\u7ED3\u679C...');\r\n"],
  "mappings": "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",
  "names": []
}
